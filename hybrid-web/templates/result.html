<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <script type="text/javascript">
      google.charts.load('current', {'packages':['bar']});
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
        var keys = {{keys|safe}};
        var vals = {{vals|safe}};
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'POIs');
        data.addColumn('number', 'Rating');
        for(var index in keys){
          data.addRow([keys[index],vals[index]]);
        };

        var options = {
          chart: {
          },
          bars: 'vertical' // Required for Material Bar Charts.
        };

        var chart = new google.charts.Bar(document.getElementById('barcomp'));

        chart.draw(data, google.charts.Bar.convertOptions(options));
      }
    </script>

    <script type="text/javascript">
      google.charts.load('current', {'packages':['bar']});
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
        var news = {{publishd|safe}};

        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Publishers');
        data.addColumn('number', 'Number or articles');
        for(var index in news){
          data.addRow([index,news[index]]);
          
        };

        var options = {
          chart: {
          },
          bars: 'vertical' // Required for Material Bar Charts.
        };

        var chart = new google.charts.Bar(document.getElementById('neww'));

        chart.draw(data, google.charts.Bar.convertOptions(options));
      }
    </script>

    <script type="text/javascript">
      google.charts.load('current', {'packages':['bar']});
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
        var news = {{posters|safe}};

        var data = new google.visualization.DataTable();
        data.addColumn('string', 'POIs');
        data.addColumn('number', 'Number Tweets');
        for(var index in news){
          data.addRow([index,news[index]]);
          
        };

        var options = {
          chart: {
          },
          bars: 'vertical' // Required for Material Bar Charts.
        };

        var chart = new google.charts.Bar(document.getElementById('postss'));

        chart.draw(data, google.charts.Bar.convertOptions(options));
      }
    </script>

    <script type="text/javascript">
      google.charts.load('current', {'packages':['bar']});
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
        var can = {{influence|safe}};

        var data = new google.visualization.DataTable();
        data.addColumn('string', 'POIs');
        data.addColumn('number', 'Influencer Score');
        for(var index in can){
          data.addRow([index,can[index]]);
          
        };

        var options = {
          chart: {
          },
          bars: 'vertical' // Required for Material Bar Charts.
        };

        var chart = new google.charts.Bar(document.getElementById('inf'));

        chart.draw(data, google.charts.Bar.convertOptions(options));
      }
    </script>

    <title>Search Results</title>
  </head>
  <body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-light bg-info">
        <b class="navbar-brand" href="/">Hybrid</b>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link" href="/">Home<span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/insights">Insights</a>
            </li>
            <li class="nav-item active">
              <a class="nav-link" href="#">Results<span class="sr-only">(current)</span></a>
            </li>
          </ul>
        </div>
    </nav>
    <!-- Search -->
    <form action="#", method="post">
      <div class="form-row">
        <div class="col-sm-3">
          <label class="InitSearch" for="Init">Search:</label>
          <input type="text" class="form-control" name="sval" value={{quey}}>
        </div>
        <div class="col-sm-2">
          <label for="exampleFormControlSelect1">POI</label>
          <select type="text" class="form-control" name="POIstate" >
            <option selected>Select</option>
            <option>RealDonaldTrump</option>
            <option>GavinNewsom</option>
            <option>CDCgov</option>
            <option>Matteorenzi</option>
            <option>Narendramodi</option>
            <option>lauraboldrini</option>
            <option>drharshvardhan</option>
            <option>nitin_gadkari</option>
            <option>secazar</option>
            <option>gualtierieurope</option>
            <option>matteosalvinimi</option>
            <option>nygovcuomo</option>
            <option>thekiranbedi</option>
            <option>pemakhandubjp</option>
            <option>ministerosalute</option>
          </select>
        </div>
        <div class="col-sm-2">
          <label for="exampleFormControlSelect1">Language</label>
          <select type="text" class="form-control" name="LANGstate">
            <option selected>Select</option>
            <option>en</option>
            <option>it</option>
            <option>hi</option>
          </select>
        </div>
        <div class="col-sm-2">
          <label for="exampleFormControlSelect1">Location</label>
          <select type="text" class="form-control" name="Lstate">
            <option selected>Select</option>
            <option>USA</option>
            <option>Italy</option>
            <option>India</option>
          </select>
        </div>
        <div class="col-sm-2">
          <label for="exampleFormControlSelect1">Topic</label>
          <select type="text" class="form-control" name="Tstate">
            <option selected>Select</option>
            <option>covid</option>
            <option>politics</option>
            <option>vaccine</option>
          </select>
        </div>
        <div class="col-sm-8">
          <input type="submit" value="submit" class="btn btn-primary" style="margin-top:10px; box-shadow: 1px 5px 3px grey;"/>
        </div>
      </div>
    </form>
    <!-- results -->
    <div>
      <div>
        <br />
        <p>Number of Results: {{num}}</p>
      </div>
      <div class='d-flex bd-highlight'>
        <div class="p-2 flex-fill bd-highlight">
          <h2>Tweets</h2>
          {% if num == 0 %}
          <div class="card" style="width: 37vw; justify-content: center;">
            <div class="card-body">
              <h5 class="card-title">No Tweet Results Found</h5>
              <h5 class="card-title">Please conduct another search</h5>
            </div>
          </div>
          {% endif %}
          {% for tweet in top %}
            <a href={{tweet[7]}} target="_blank" class="card" style="width: 37vw; justify-content: center; text-decoration: none; color: black;">
              <div class="card-body">
                <h5 class="card-title">@{{tweet[0]}}</h5>
                <h6 class="card-subtitle mb-2 text-muted">Location: {{tweet[2]}} Time: {{tweet[3]}}</h6>
                <p class="card-text">{{tweet[1]}}</p>
                <p class="card-text">Retweets: {{tweet[4]}} Favorites: {{tweet[5]}} Sentiment: {{tweet[6]}}</p>
              </div>
            </a>
          {% endfor %}
        </div>

        <div class="p-2 flex-fill bd-highlight">
          <h2>News</h2>
          {% for article in news %}
          <div class="card" style="width: 31vw; justify-content: center;">
            <div class="card-body">
              <h5 class="card-title">{{article[0]}}</h5>
              <h6 class="card-subtitle mb-2 text-muted">{{article[3]}}</h6>
              <p class="card-text">{{article[1]}}</p>
              <a href={{article[2]}} class="btn btn-primary" target="_blank">Link</a>
            </div>
          </div>
          {% endfor %}
        </div>

        <div class="p-2 flex-fill bd-highlight">
          <h2>Stats</h2>
          <div class="card" style="width: 29vw; justify-content: center;">
            <div class="card-body">
              <h5 class="card-title" style="text-decoration: underline;">POIs Sentiments</h5>
              <div id="barcomp" style="width: 100%; justify-content: center;"></div>
            </div>
          </div>
          <div class="card" style="width: 29vw; justify-content: center;">
            <div class="card-body">
              <h5 class="card-title" style="text-decoration: underline;">News Publishers</h5>
              <div id="neww" style="width: 100%; justify-content: center;"></div>
            </div>
          </div>
          <div class="card" style="width: 29vw; justify-content: center;">
            <div class="card-body">
              <h5 class="card-title" style="text-decoration: underline;">Distribution of Tweets</h5>
              <div id="postss" style="width: 100%; justify-content: center;"></div>
            </div>
          </div>
          <div class="card" style="width: 29vw; justify-content: center;">
            <div class="card-body">
              <h5 class="card-title" style="text-decoration: underline;">POI Influencer Scores</h5>
              <div id="inf" style="width: 100%; justify-content: center;"></div>
            </div>
          </div>

        </div>

      </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  </body>
</html>